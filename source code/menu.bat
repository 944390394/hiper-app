set path==%path%;%appdata%\hiper

set moed=menujd

mode con cols=70 lines=14

@echo off

set  tapexamine=未知错误
set  hiperexamine=未知错误
set  wgetexamine=未知错误
set  chatfreeexamine=未知错误
set  saterhiperexamine=未知错误
set  saterhiperfreeexamine=未知错误
set v=1.0.0（完结版）
set qq=銆?44390394銆?
set zz=梦游
set /a Randomnumber=%random%%%50+1


:Title
if "%Randomnumber%"=="1" title %zz%联机启动器 ┃ 这次我们更新了114514个特性！
if "%Randomnumber%"=="2" title %zz%联机启动器 ┃ 当你看到这条tip，你一定就看到了它！
if "%Randomnumber%"=="3" title %zz%联机启动器 ┃ 前方通往快乐
if "%Randomnumber%"=="4" title %zz%联机启动器 ┃ This is hiper world！
if "%Randomnumber%"=="5" title %zz%联机启动器 ┃ 也试试cato！
if "%Randomnumber%"=="6" title %zz%联机启动器 ┃ 摸鱼法则
if "%Randomnumber%"=="7" title %zz%联机启动器 ┃ 摸鱼是不好的行为!
if "%Randomnumber%"=="8" title %zz%联机启动器 ┃ 咕咕咕，刷到这条tip需要多少次呢
if "%Randomnumber%"=="9" title %zz%联机启动器 ┃ 合理安排时间，享受健康生活
if "%Randomnumber%"=="10" title %zz%联机启动器 ┃ 可以去看看我的GitHub哦!
if "%Randomnumber%"=="12" title %zz%联机启动器 ┃ 鸽王再世
if "%Randomnumber%"=="13" title %zz%联机启动器 ┃ 如此生活30年，直到大厦崩塌。
if "%Randomnumber%"=="14" title %zz%联机启动器 ┃ 你强归你强，我永不示弱。
if "%Randomnumber%"=="15" title %zz%联机启动器 ┃ 相互间的抚慰根本没必要只要你还存在着就足够
if "%Randomnumber%"=="16" title %zz%联机启动器 ┃ 且将新火试新茶，诗酒趁年华
if "%Randomnumber%"=="17" title %zz%联机启动器 ┃ 错的不是我，而是这个世界！
if "%Randomnumber%"=="18" title %zz%联机启动器 ┃ 你跳不出这个世界，是因为你不知道这个世界有多大，一旦你知道了，你就超出了它。
if "%Randomnumber%"=="19" title %zz%联机启动器 ┃ 相思了无益，悔当初相见。
if "%Randomnumber%"=="20" title %zz%联机启动器 ┃ 自童年起，我便独自一人，照顾着历代星辰。
if "%Randomnumber%"=="21" title %zz%联机启动器 ┃ 彼岸花花开彼岸，断肠草草断肝肠。
if "%Randomnumber%"=="22" title %zz%联机启动器 ┃ 生命，不过只是一场骗局，从你开始呼吸的那一刻起，你就已经在慢慢死亡了。
if "%Randomnumber%"=="23" title %zz%联机启动器 ┃ 我们不能成为贵族的后代，但我们可以变成贵族的祖先
if "%Randomnumber%"=="24" title %zz%联机启动器 ┃ 世间好物不坚牢，彩云易散琉璃脆。
if "%Randomnumber%"=="25" title %zz%联机启动器 ┃ 彼岸花花开彼岸，断肠草草断肝肠。
if "%Randomnumber%"=="26" title %zz%联机启动器 ┃ 春心莫共花争发，一寸相思一寸灰！
if "%Randomnumber%"=="27" title %zz%联机启动器 ┃ 我要做一颗星星，有棱有角，还会发光。
if "%Randomnumber%"=="28" title %zz%联机启动器 ┃ 我恨自己。我爱自己。
if "%Randomnumber%"=="29" title %zz%联机启动器 ┃ 昆山玉碎凤凰叫，芙蓉泣露香兰笑。
if "%Randomnumber%"=="30" title %zz%联机启动器 ┃ 只有分离后才能懂的事，却没有了感慨的时间。
if "%Randomnumber%"=="31" title %zz%联机启动器 ┃ 地狱太冷，我来殉你。
if "%Randomnumber%"=="32" title %zz%联机启动器 ┃ 人生到处知何似，应似飞鸿踏雪泥。
if "%Randomnumber%"=="33" title %zz%联机启动器 ┃ 飘零的孤鸟，也有权利寻求幸福啊。
if "%Randomnumber%"=="34" title %zz%联机启动器 ┃ Think twice, code once.
if "%Randomnumber%"=="35" title %zz%联机启动器 ┃ Think twice, code once.
if "%Randomnumber%"=="36" title %zz%联机启动器 ┃ 以前喜欢一个人，现在喜欢一个人。
if "%Randomnumber%"=="37" title %zz%联机启动器 ┃ 以前喜欢一个人，现在喜欢一个人。
if "%Randomnumber%"=="38" title %zz%联机启动器 ┃ 以前喜欢一个人，现在喜欢一个人。
if "%Randomnumber%"=="39" title %zz%联机启动器 ┃ 时间是存在者的时间。
if "%Randomnumber%"=="40" title %zz%联机启动器 ┃ 韶华不为少年留。恨悠悠。几时休。
if "%Randomnumber%"=="41" title %zz%联机启动器 ┃ 你睁开眼睛的时候，我在这里。
if "%Randomnumber%"=="42" title %zz%联机启动器 ┃ 如果可以的话，我也想成为这个世界中特殊的存在。
if "%Randomnumber%"=="43" title %zz%联机启动器 ┃ 遇到事情不能坐以待毙！
if "%Randomnumber%"=="44" title %zz%联机启动器 ┃ 没有回忆就去创造回忆，没有道路就去开辟道路。
if "%Randomnumber%"=="45" title %zz%联机启动器 ┃ 数学分析？我已经完全掌握了。
if "%Randomnumber%"=="46" title %zz%联机启动器 ┃ 我等你十三载，你如何回我？
if "%Randomnumber%"=="47" title %zz%联机启动器 ┃ 人生天地之间，若白驹之过隙，忽然而已。
if "%Randomnumber%"=="48" title %zz%联机启动器 ┃ 今天的早餐是：早苗的面包、秋子的果酱和观铃的果汁~
if "%Randomnumber%"=="49" title %zz%联机启动器 ┃ 庭前落尽梧桐，水边开彻芙蓉。
if "%Randomnumber%"=="50" title %zz%联机启动器 ┃ 儿童散学归来早，忙趁东风放纸鸢。



goto Selftest

:Selftest
set tapexamine=正常
if not exist %appdata%\hiper\tap-windows-9.21.2.exe set tapexamine=未检测到文件
set hiperexamine=正常
if not exist %appdata%\hiper\hiper.exe set hiperexamine=未检测到文件
set  saterhiperexamine=正常
if not exist %appdata%\hiper\saterhiper.exe set saterhiperexamine=未检测到文件
set  saterhiperfreeexaminhe=正常
set  wgetexamine=正常
if not exist %appdata%\hiper\wget.exe set wgetexamine=未检测到文件
set  hprexamine=正常
if %hiperexamine%==未检测到文件  goto error
if %tapexamine%==未检测到文件 goto error
if %saterhiperexamine%==未检测到文件 goto error
if %saterhiperfreeexamine%==未检测到文件 goto error
if %wgetexamine%==未检测到文件 goto error
if %hprexamine%==未检测到文件 goto error
goto %moed%

:error
echo ------------------------自检报告--------------------------
echo 自检遇到错误，请检查文件位置，或重新启动本程序
echo 网卡安装程序：【%tapexamine%】
echo hiper主程序 ：【%hiperexamine%】
echo hiper plus主程序 ：【%hprexamine%】
echo 凭证联机模块： 【%saterhiperfreeexamine%】
echo 下载模块：【%wgetexamine%】
echo 网卡状态：【%tapsater%】
echo 如果你在此处遇到问题，且无法自行解决，请联系QQ：944390394
echo 注意：时刻保持一颗清醒的头脑和一颗谦虚的心灵会让你的问题更快得到解决！
echo.
echo 按任意键退出
pause>nul


:zjj
set tapexamine=正常
if not exist %appdata%\hiper\tap-windows-9.21.2.exe set tapexamine=未检测到文件
set hiperexamine=正常
if not exist %appdata%\hiper\hiper.exe set hiperexamine=未检测到文件
if %n% GEQ 60 goto error
if %hiperexamine%==未检测到文件  goto error
if %tapexamine%==未检测到文件 goto error
goto abc

:abc
if not exist %appdata%\hiper\hiper.exe goto nofile
goto %moed%

:nofile
set /a n+=1
echo ********************************************
echo ********************************************
echo **                                        **
echo **  未能测到hiper程序，正在尝试重新下载 **
echo **  当前重试次数→%n%←(60次封顶)  **
echo ********************************************
echo ********************************************
%appdata%\hiper\wget.exe -q -P %appdata%\hiper -S -N -t 50  https://gitcode.net/to/hiper/-/blob/master/windows-386/hiper.exe
%appdata%\hiper\wget.exe  -q -P %appdata%\hiper  -S -N -t 50  https://gitcode.net/to/hiper/-/raw/master/tap-windows-9.21.2.exe
if %n% GEQ 60 goto shibai
goto abc

:shibai
echo ********************************************
echo ********************************************
echo **      未能测到hiper程序，且无法下载       **
echo **        请检查网络环境或联系管理员          **
echo **              作者QQ：944390394               **
echo ********************************************
echo ********************************************
pause
cls
exit


:menufz
set ID=0
set moed=menufz
mode con cols=55 lines=27
set /P OEM=<%appdata%\hiper\version.txt
set tapsater=已安装
if not exist C:\Windows\System32\drivers\tap0901.sys set tapsater=未安装
ECHO.       ---------------HiPer启动程序-----------
ECHO.       -    （1）→ 安装HiPer虚拟网卡←      -
ECHO.       -    （2）→ 打开mc房间辅助器←      -
ECHO.       ---------------------------------------
ECHO.       -    （3） 启动HiPer程序              -
ECHO.       -    （4） 创建快捷方式到桌面         -
ECHO.       ---------------------------------------
ECHO.       -    （H） 打开HiPer帮助              -
ECHO.       -    （Z） 返回简易模式               -
ECHO.       ---------------------------------------
ECHO.       -       hiper版本：【%OEM%】           -
ECHO.       -       网卡状态：【%tapsater%】          -
ECHO.       ---------------------------------------
ECHO.       -  注：无凭证入网每30分钟切断一次连接 -
ECHO.       -      版本：%v%   作者：%zz%   -
ECHO.       -      BUG反馈/邀请码购买/使用咨询    -
ECHO.       -             作者QQ:%qq%        -
ECHO.       -          官方①群：235256586        -
ECHO.       -          官方②群：212927890        -
ECHO.       -          官方③群：93365639        -
ECHO.       -          官方④群：93364993        -
ECHO.       ---------------------------------------
ECHO.       -        当前日期：%date%    -
ECHO.       -          启动时间：%time%      -
ECHO.       ---------------------------------------
echo.请输入选择项目的序号：
set /p ID=
if “%id%”==“1” goto Installationtap

if “%id%”==“3” goto saterHiPer

if “%id%”==“2” start mcfj

if “%id%”==“4” goto cmd5

if “%id%”==“114514” goto cmd8

if “%id%”==“H” goto help

if “%id%”==“h” goto help

if “%id%”==“hiper-kit” goto kit

if “%id%”==“hiper-kitmain” goto kitmain

if “%id%”==“z” goto menujd

if “%id%”==“Z” goto helpjd

if “%id%”==“openappdata” start %appdata%\hiper

goto %moed%

:menujd
set eID=0
set moed=menujd
mode con cols=62 lines=15
set /P OEM=<%appdata%\hiper\version.txt
set tapsater=已安装
ECHO. 
ECHO.          ----------HiPer启动程序（简易模式）----
ECHO.          -                                     -
ECHO.          -    （1）→   启动HiPer程序  ←      -
ECHO.          -                                     -
ECHO.          ---------------------------------------
ECHO.          -    （Z）→   赞赏作者（梦游）   ←  -
ECHO.          -    （H）→   进入普通模式   ←      -
ECHO.          ---------------------------------------
echo.请输入选择项目的序号：
set /p eID=

if “%eid%”==“1” goto saterHiPer


if “%eid%”==“H” goto menufz

if “%eid%”==“h” goto menufz
if “%eid%”==“Z” goto zs

if “%eid%”==“z” goto zs
goto %moed%



:zs
start https://s1.328888.xyz/2022/08/03/O8cdm.png
goto %moed%



:Installationtap
cls
if not exist C:\Windows\System32\drivers\tap0901.sys goto saterapp
::这里是判断用户是否安装过虚拟网卡 https://zhidao.baidu.com/question/1046357538354738819.html
echo         -                                -
echo         -   检测到你已经安装了虚拟网卡   -
echo         -       确定要继续安装吗         -
echo         -                                -
echo          输入 y 确认安装；输入 n 结束安装

set /p ID=
if “%id%”==“Y” goto saterapp
if “%id%”==“y” goto saterapp
if “%id%”==“N” goto menu
if “%id%”==“n” goto menu
goto %moed%

:saterapp
cls
echo. -
echo. -请勿更改安装路径，默认即可
echo. -安装程序已打开，安装即可！
echo. -本程序不会对你的计算机造成伤害，请放心
echo. -若有杀毒软件拦截，请恢复他并加入白名单
echo. -
call %appdata%\hiper\tap-windows-9.21.2.exe
goto %moed%


:saterHiPer



cls
echo ********************************************
echo ********************************************
echo **                                        **
echo **  房主方输入（1）     加入方输入（2）   **
echo **                                        **
echo ********************************************
echo ********************************************
set /p eeID=请选择启动模式：
if “%eeid%”==“1” goto jr1
if “%eeid%”==“2” goto jr2
goto qianzhi

:qianzhi
if exist C:\Windows\System32\drivers\tap0901.sys del %appdata%\hiper\wintun.dll
if “%eeid%”==“1” goto jr1
if “%eeid%”==“2” goto jr2
goto menujd

:jr1
if exist C:\Windows\System32\drivers\tap0901.sys del %appdata%\hiper\wintun.dll
start saterhiper
exit
goto menujd


:jr2
if exist C:\Windows\System32\drivers\tap0901.sys del %appdata%\hiper\wintun.dll
start mcfj
start saterhiper
exit
goto menujd



:cmd5
@echo off
set "exe=%zz%联机启动器.exe"
set "lnk=%zz%联机启动器"
mshta VBScript:Execute("Set a=CreateObject(""WScript.Shell""):Set b=a.CreateShortcut(a.SpecialFolders(""Desktop"") & ""\%lnk%.lnk""):b.TargetPath=""%~dp0%exe%"":b.WorkingDirectory=""%~dp0"":b.Save:close")
echo 完成
cls
goto menujd


:zj
for /F %%i in ('ipconfig /all｜findstr TAP') do ( set drv=%%i)
cls
echo. ------------------------自检报告----------------------
echo. 网卡安装程序：【%tapexamine%】
echo.
echo. hiper主程序 ：【%hiperexamine%】     hiper版本：【%OEM%】
echo.
echo. 聊天程序：    【%chatfreeexamine%】
echo.
echo. 下载模块：    【%wgetexamine%】
echo.
echo. 网卡状态：    【%tapsater%】
echo.
echo. 网卡：        【%drv%】
echo.
echo. 版本：%v%
echo.
echo. 日期：%date%        时间：%time%    
echo. -------------------------------------------------------
pause
goto  %moed%

:cmd5
start https://mcer.cn/shop?ref=azAtwBwzp
cls
goto menu


:UP
%appdata%\hiper\wget.exe  -P %appdata%\hiper -S -N -t 50   https://gitcode.net/to/hiper/-/blob/master/windows-386/hiper.exe
%appdata%\hiper\wget.exe  -P %appdata%\hiper  -S -N -t 50  https://gitcode.net/to/hiper/-/raw/master/tap-windows-9.21.2.exe
%appdata%\hiper\wget.exe  -P %appdata%\hiper  -S -N -t 50  https://matrix-1300179650.cos.ap-shanghai.myqcloud.com/res/version.txt
goto Title
pause
cls
goto menu


:cmd8
cls
echo               【彩蛋】好臭的数字啊 @a@
ECHO.
ECHO.
ECHO.
ECHO.     -------------------鸣谢列表------------------
ECHO.     -      猫猫     提供hiper主程序及技术支持   -
ECHO.     -   梦游泪世    编写本程序，提供更新服务    -
ECHO.     -   起风了吗    编写本程序，提供帮助        -
ECHO.     -     烨        提供有趣的标题后缀          -
ECHO.     -野生的小乐子 提供非常有用的教程以及资金支持-
ECHO.     -------------感谢以上人员的大力支持----------
ECHO. 
ECHO. 
ECHO. 
pause
goto cmd8
goto %moed%

:kit

%appdata%\hiper\wget.exe  -q -P %appdata%\hiper  -S -N -t 50 https://matrix-1300179650.cos.ap-shanghai.myqcloud.com/res/hiper-kit.exe
if not exist %appdata%\hiper\hiper-kit.exe goto kitcs
echo.
echo. 成功
echo
pause
goto menufz

:kitcs
set /a kit+=1
echo ********************************************
echo ********************************************
echo **                                        **
echo **  未能下载测试程序，正在尝试重新下载 **
echo **  当前重试次数→%n%←(60次封顶)  **
echo ********************************************
echo ********************************************
%appdata%\hiper\wget.exe -q -P %appdata%\hiper -S -N -t 50  https://matrix-1300179650.cos.ap-shanghai.myqcloud.com/res/hiper.exe
%appdata%\hiper\wget.exe  -q -P %appdata%\hiper  -S -N -t 50  https://matrix-1300179650.cos.ap-shanghai.myqcloud.com/res/tap-windows.exe
if %kit% GEQ 60 goto shibai
goto kitcsshibai

:kitcsshibai
echo ********************************************
echo ********************************************
echo **      未能下载测试程序，且无法下载       **
echo **        请检查网络环境或联系管理员          **
echo ********************************************
echo ********************************************
pause
cls
exit

:kitmain
ECHO.       ---------------kit帮助页面-----------
ECHO.       -    （1） hiper-kit l                   -
ECHO.       -    （2） hiper-kit l --server      -
ECHO.       -    （3） hiper-kit t  -
ECHO.       -    （4） hiper-kit t --server        -
ECHO.       -    （H） 回到主菜单                 -
ECHO.       -    非专业人士请勿使用此参数，避免带来麻烦                 -
ECHO.       -    此参数为测试人员专业，如不小心打开请直接返回主菜单                 -
echo.       ---------------------------------------
echo.请输入选择项目的序号：
set /p kit=
if “%kit%”==“1” start cmd /k %appdata%\hiper\hiper-kit.exe l
if “%kit%”==“2” start cmd /k %appdata%\hiper\hiper-kit.exe l --server
if “%kit%”==“3” start cmd /k %appdata%\hiper\hiper-kit.exe t  -
if “%kit%”==“4” start cmd /k %appdata%\hiper\hiper-kit.exe t --server
if “%kit%”==“H” goto menu
if “%kit%”==“h” goto menu
goto kitmain









:help
set help=0
cls
ECHO.       ---------------HiPer帮助页面-----------
ECHO.       -    （1） 打开凭证购买页面(货币兑换) -
ECHO.       -    （2） 打开凭证购买页面(积分兑换) -
ECHO.       -    （3） 打开HiPer教程 （起风了吗） -
ECHO.       -    （4） 打开HiPer教程 （梦游泪世） -
ECHO.       -    （5） 打开HiPer教程 （野生的小乐子） -
ECHO.       -    （5） 手动检查启动器更新          -
ECHO.       -    （J） 手动检查文件完整度         -
ECHO.       -    （U） 手动检查hiper更新          -
ECHO.       -    （H） 回到主菜单                 -
echo.       ---------------------------------------
echo.请输入选择项目的序号：
set /p help=
if “%help%”==“1” goto help1
if “%help%”==“2” goto help2
if “%help%”==“3” goto help3
if “%help%”==“4” goto help4
if “%help%”==“5” goto help6
if “%help%”==“6” goto help5
if “%help%”==“H” goto %moed%
if “%help%”==“h” goto  %moed%
if “%help%”==“u” goto UP
if “%help%”==“U” goto UP
if “%help%”==“J” goto zj
if “%help%”==“j” goto zj
goto help

:help1
start https://mcer.cn/shop/122.html
cls
goto help

:help2
https://mcer.cn/shop/123.html?ref=azAtwBwzp
cls
goto help

:help3
start https://zkitefly.github.io/hiper-d/playminecraft.html
cls
goto help


:help4
start https://mcer.cn/463.html?ref=azAtwBwzp
cls
goto help

:help5
start https://mcer.cn/circle/491.html?ref=azAtwBwzp
cls
goto help

:help6
start https://mcer.cn/527.html?ref=gulkrjrpj
cls
goto help